<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Connect Wallet to Smart Contract</title>
  <script src="https://cdn.jsdelivr.net/npm/web3/dist/web3.min.js"></script>
</head>
<body>
  <h1>Hubungkan Wallet ke Smart Contract</h1>
  <button id="connectWallet">Hubungkan Wallet</button>
  <p><strong>Status Wallet:</strong> <span id="walletStatus">Belum Terhubung</span></p>
  <p><strong>Smart Contract Address:</strong> <span id="contractStatus">Belum Terhubung</span></p>

  <script>
    const contractAddress = "0xc520027d3eB2600c5ea5e799ea6F355D05b8b6f6";
    const abi = [
      {
        "inputs": [
          { "internalType": "address", "name": "sender", "type": "address" },
          { "internalType": "address", "name": "recipient", "type": "address" },
          { "internalType": "uint256", "name": "amount", "type": "uint256" }
        ],
        "name": "transferFrom",
        "outputs": [
          { "internalType": "bool", "name": "", "type": "bool" }
        ],
        "stateMutability": "nonpayable",
        "type": "function"
      }
    ];

    let web3;
    let userAccount;

    document.getElementById("connectWallet").addEventListener("click", async () => {
      if (window.ethereum) {
        try {
          // Meminta akses ke wallet
          await window.ethereum.request({ method: 'eth_requestAccounts' });
          web3 = new Web3(window.ethereum);

          // Mendapatkan akun pengguna
          userAccount = (await web3.eth.getAccounts())[0];
          document.getElementById("walletStatus").textContent = "Terhubung: " + userAccount;

          // Inisialisasi contract
          const contract = new web3.eth.Contract(abi, contractAddress);
          document.getElementById("contractStatus").textContent = "Terhubung: " + contractAddress;
        } catch (error) {
          console.error("Gagal menghubungkan wallet:", error);
          alert("Gagal menghubungkan wallet.");
        }
      } else {
        alert("Metamask tidak ditemukan! Harap instal Metamask untuk melanjutkan.");
      }
    });
  </script>
</body>
</html>
